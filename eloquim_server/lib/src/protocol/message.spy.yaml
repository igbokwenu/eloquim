#eloquim_server/lib/src/protocol/message.spy.yaml
class: Message
table: messages
fields:
  # Relations: Serverpod auto-generates 'int conversationId' and 'int senderId'
  conversation: Conversation?, relation
  sender: User?, relation

  emojiSequence: List<String>
  rawIntent: String?
  translatedText: String
  tone: String, default="casual"
  personaUsed: String
  confidenceScore: double, default=0.0
  mediaGifUrl: String?
  replyToMsgId: int?
  recommendedEmojis: List<String>?
  createdAt: DateTime, default=now
  deliveredAt: DateTime?
  readAt: DateTime?
  isEncrypted: bool, default=false

indexes:
  messages_conversation_idx:
    fields: conversationId, createdAt
    type: btree
  messages_sender_idx:
    fields: senderId, createdAt
    type: btree
